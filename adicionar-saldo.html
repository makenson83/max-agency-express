
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Adicionar Saldo via Pix</title>
  <script>
    async function gerarPix() {
      const valor = parseFloat(document.getElementById("valor").value);
      if (isNaN(valor) || valor < 1) {
        alert("Digite um valor válido acima de R$1");
        return;
      }

      const response = await fetch("https://api.mercadopago.com/v1/payments", {
        method: "POST",
        headers: {
          "Authorization": "Bearer APP_USR-7962833792436627-072523-8ffea118ee1504c171f5b0097b0c3e84-2495062492",
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          transaction_amount: valor,
          description: "Adicionar saldo Max Agency",
          payment_method_id: "pix",
          payer: {
            email: "cliente@email.com",
            first_name: "Cliente"
          }
        })
      });

      const data = await response.json();

      if (data.status === 'rejected' || data.message) {
        alert("Erro: " + (data.message || "não foi possível gerar o Pix"));
        return;
      }

      document.getElementById("qrcode").src = data.point_of_interaction.transaction_data.qr_code_base64;
      document.getElementById("copiar").value = data.point_of_interaction.transaction_data.qr_code;
    }
  </script>
</head>
<body>
  <h2>Adicionar Saldo via Pix</h2>
  <input type="number" id="valor" placeholder="Valor em R$">
  <button onclick="gerarPix()">Gerar Pix</button>

  <div id="pix-area" style="margin-top:20px;">
    <img id="qrcode" style="width:250px;height:250px;"><br>
    <input id="copiar" style="width:100%;" readonly><br>
    <small>Copie o código Pix acima ou escaneie o QR Code</small>
  </div>
</body>
</html>
